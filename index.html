<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Food Delivery App with Cart</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f4f4f4; }
  h1 { color: #333; }
  .filter-section, .payment-section, .buttons, .cart-section { margin-top: 20px; }
  .food-menu { display: flex; flex-wrap: wrap; gap: 15px; margin-top: 20px; }
  .food-item {
    background: white;
    border-radius: 5px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    cursor: pointer;
    width: 140px;
    padding: 10px;
    text-align: center;
    transition: box-shadow 0.3s ease;
    position: relative;
  }
  .food-item:hover {
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
  }
  .food-item img {
    width: 100px;
    height: 100px;
    object-fit: cover;
    border-radius: 5px;
  }
  .food-name {
    font-weight: bold;
    margin-top: 10px;
  }
  .food-price {
    color: #555;
    margin-top: 4px;
  }
  .add-cart-btn {
    margin-top: 8px;
    padding: 5px 10px;
    background: #007bff;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }
  .add-cart-btn:hover {
    background: #0056b3;
  }
  .cart-section {
    background: white;
    padding: 15px;
    border-radius: 5px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    max-width: 400px;
  }
  .cart-section h2 {
    margin-top: 0;
  }
  .cart-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 8px;
  }
  .cart-total {
    font-weight: bold;
    margin-top: 10px;
  }
  #proceedPaymentBtn:disabled, #placeOrderBtn:disabled, #cancelOrderBtn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  #paymentSection {
    display: none; /* Hidden initially */
    margin-top: 20px;
    background: white;
    padding: 15px;
    border-radius: 5px;
    max-width: 400px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
  }
  .order-status {
    margin-top: 20px;
    font-weight: bold;
    font-size: 1.2em;
  }
</style>
</head>
<body>
  <h1>FoodieXpress</h1>

  <div class="filter-section">
    <label>Filter Menu: </label>
    <select id="vegFilter">
      <option value="all">All</option>
      <option value="veg">Vegetarian</option>
      <option value="nonveg">Non-Vegetarian</option>
    </select>
  </div>

  <div class="food-menu" id="foodMenu">
    <!-- Food items dynamically shown here -->
  </div>

  <div class="cart-section">
    <h2>Cart</h2>
    <div id="cartItems">
      <p>Your cart is empty</p>
    </div>
    <div class="cart-total" id="cartTotal">Total: ‚Çπ0</div>
    <button id="proceedPaymentBtn" disabled>Proceed to Payment</button>
  </div>

  <div id="paymentSection">
    <h2>Payment</h2>
    <label for="payment">Select payment method:</label>
    <select id="payment">
      <option value="creditCard">Credit Card</option>
      <option value="paypal">PayPal</option>
      <option value="cod">Cash On Delivery (COD)</option>
    </select>
    <div class="buttons" style="margin-top:10px;">
      <button id="placeOrderBtn">Place Order</button>
      <button id="cancelOrderBtn" disabled>Cancel Order</button>
    </div>
  </div>

  <div class="order-status" id="orderStatus">Order Status: None</div>

<script>
// Food Data
const foods = [
  { id: 'pizza', name: 'Pizza', price: 250, veg: false, image: 'https://api.pizzahut.io/v1/content/en-in/in-1/images/pizza/tandoori-paneer.345b2b76013be77de027ba09aff9abe6.1.jpg' },
  { id: 'burger', name: 'Chicken Burger', price: 150, veg: false, image: 'https://media-assets.swiggy.com/swiggy/image/upload/fl_lossy,f_auto,q_auto,w_366/RX_THUMBNAIL/IMAGES/VENDOR/2025/6/18/ee1fdf16-ea5f-4a44-9e58-7b3a9dee2618_8614.jpg' },
  { id: 'sushi', name: 'Sushi', price: 350, veg: false, image: 'https://lh6.googleusercontent.com/proxy/b6btKWMVsoM3H2i--nELJ6p9LNL48d8NYh5LCN9uPIR2LxAOLtUzlOH5bEEVXRFGVnyaPa9HwWmjs5Mm5dJJFkwdvEm5suVDfqKbzLXgimfYuDrPSVRvjTs8lpfybpI3LTS4kzWPSX0EOIL65e9kEvFwegNQnNqlTd53knM6Wbg2GEpJNSMZM7oLoxY' },
  { id: 'salad', name: 'Salad', price: 100, veg: true, image: 'https://www.primalkitchen.com/cdn/shop/articles/20240905221054-pk-greek-salad-0214-min.jpg?v=1725643684' },
  { id: 'paneer', name: 'Paneer Tikka', price: 200, veg: true, image: 'https://sharethespice.com/wp-content/uploads/2024/02/Paneer-Tikka-Featured.jpg' },
  { id: 'pasta', name: 'Pasta', price: 220, veg: true, image: 'https://www.yummytummyaarthi.com/wp-content/uploads/2022/11/red-sauce-pasta-1-500x500.jpg' },
  {id: 'Biryani', name: 'Biryani', price: 150, veg: false, image:'https://i0.wp.com/binjalsvegkitchen.com/wp-content/uploads/2025/05/Veg-Kofta-Biryani-H1.jpg?fit=600%2C900&ssl=1'},
];

// Observer Pattern
class OrderSubject {
  constructor() {
    this.observers = [];
    this.status = 'None';
  }
  registerObserver(observer) {
    this.observers.push(observer);
  }
  removeObserver(observer) {
    this.observers = this.observers.filter(obs => obs !== observer);
  }
  notifyObservers() {
    this.observers.forEach(obs => obs.update(this.status));
  }
  setStatus(status) {
    this.status = status;
    this.notifyObservers();
  }
}

class OrderStatusDisplay {
  constructor(displayElement) {
    this.displayElement = displayElement;
  }
  update(status) {
    this.displayElement.textContent = Order Status: ${status};
  }
}

// Strategy Pattern
class CreditCardPayment {
  pay(amount) {
    alert(Paid ‚Çπ${amount} using Credit Card);
  }
}
class PaypalPayment {
  pay(amount) {
    alert(Paid ‚Çπ${amount} using PayPal);
  }
}
class CODPayment {
  pay(amount) {
    alert(Payment of ‚Çπ${amount} will be collected on delivery);
  }
}

// Command Pattern
class Command {
  execute() { }
  undo() { }
}
class PlaceOrderCommand extends Command {
  constructor(orderApp) { super(); this.orderApp = orderApp; }
  execute() { this.orderApp.placeOrder(); }
  undo() { this.orderApp.cancelOrder(); }
}
class CancelOrderCommand extends Command {
  constructor(orderApp) { super(); this.orderApp = orderApp; }
  execute() { this.orderApp.cancelOrder(); }
  undo() { this.orderApp.placeOrder(); }
}
class OrderInvoker {
  setCommand(command) { this.command = command; }
  executeCommand() { this.command.execute(); }
  undoCommand() { this.command.undo(); }
}

// Main App Logic
class FoodDeliveryApp {
  constructor() {
    this.orderSubject = new OrderSubject();
    this.orderStatusDisplay = new OrderStatusDisplay(document.getElementById('orderStatus'));
    this.orderSubject.registerObserver(this.orderStatusDisplay);

    this.paymentStrategy = null;
    this.cart = {}; // {foodId: qty}
    this.orderPlaced = false;

    this.invoker = new OrderInvoker();
  }

  setPaymentStrategy(strategy) { this.paymentStrategy = strategy; }

  addToCart(foodId) {
    if (this.orderPlaced) {
      alert("Cancel current order before adding items.");
      return;
    }
    if (this.cart[foodId]) {
      this.cart[foodId]++;
    } else {
      this.cart[foodId] = 1;
    }
    updateCartDisplay();
    document.getElementById('proceedPaymentBtn').disabled = false;
  }

  removeFromCart(foodId) {
    if (this.orderPlaced) {
      alert("Cancel current order before removing items.");
      return;
    }
    if (this.cart[foodId]) {
      this.cart[foodId]--;
      if (this.cart[foodId] <= 0) delete this.cart[foodId];
      updateCartDisplay();
      if (Object.keys(this.cart).length === 0) {
        document.getElementById('proceedPaymentBtn').disabled = true;
      }
    }
  }

  getCartItems() {
    return Object.entries(this.cart).map(([id, qty]) => {
      const food = foods.find(f => f.id === id);
      return { ...food, quantity: qty };
    });
  }

  getCartTotal() {
    return this.getCartItems().reduce((sum, item) => sum + item.price * item.quantity, 0);
  }

  placeOrder() {
    if (this.orderPlaced) {
      alert("Order already placed!");
      return;
    }
    if (Object.keys(this.cart).length === 0) {
      alert("Cart is empty!");
      return;
    }
    const amount = this.getCartTotal();
    this.paymentStrategy.pay(amount);
    this.orderSubject.setStatus(Order Placed: ${Object.keys(this.cart).length} item(s));
    this.orderPlaced = true;

    // UI updates
    document.getElementById('cancelOrderBtn').disabled = false;
    document.getElementById('placeOrderBtn').disabled = true;
    document.getElementById('proceedPaymentBtn').disabled = true;
    document.getElementById('paymentSection').style.display = 'block';
  }

  cancelOrder() {
    if (!this.orderPlaced) {
      alert("No order to cancel!");
      return;
    }
    this.orderSubject.setStatus('Order Cancelled');
    this.orderPlaced = false;
    this.cart = {};

    updateCartDisplay();

    document.getElementById('cancelOrderBtn').disabled = true;
    document.getElementById('placeOrderBtn').disabled = true;
    document.getElementById('proceedPaymentBtn').disabled = true;
    document.getElementById('paymentSection').style.display = 'none';
  }
}

const app = new FoodDeliveryApp();

// UI Elements
const foodMenu = document.getElementById('foodMenu');
const vegFilter = document.getElementById('vegFilter');
const cartItemsDiv = document.getElementById('cartItems');
const cartTotalDiv = document.getElementById('cartTotal');
const proceedPaymentBtn = document.getElementById('proceedPaymentBtn');
const paymentSelect = document.getElementById('payment');
const placeOrderBtn = document.getElementById('placeOrderBtn');
const cancelOrderBtn = document.getElementById('cancelOrderBtn');
const paymentSection = document.getElementById('paymentSection');

// Render food menu with Add to Cart buttons
function renderMenu(filter = 'all') {
  foodMenu.innerHTML = '';
  let filteredFoods = foods;
  if (filter === 'veg') filteredFoods = foods.filter(f => f.veg);
  else if (filter === 'nonveg') filteredFoods = foods.filter(f => !f.veg);

  filteredFoods.forEach(food => {
    const div = document.createElement('div');
    div.className = 'food-item';
    div.title = ${food.name} - ‚Çπ${food.price};
    div.innerHTML = `
      <img src="${food.image}" alt="${food.name}" />
      <div class="food-name">${food.name}</div>
      <div class="food-price">‚Çπ${food.price}</div>
      <div>${food.veg ? 'üå± Veg' : 'üçó Non-Veg'}</div>
      <button class="add-cart-btn">Add to Cart</button>
    `;
    const btn = div.querySelector('button');
    btn.addEventListener('click', () => {
      app.addToCart(food.id);
    });
    foodMenu.appendChild(div);
  });
}

// Update Cart Display
function updateCartDisplay() {
  const items = app.getCartItems();
  cartItemsDiv.innerHTML = '';
  if (items.length === 0) {
    cartItemsDiv.innerHTML = '<p>Your cart is empty</p>';
    cartTotalDiv.textContent = 'Total: ‚Çπ0';
    return;
  }
  items.forEach(item => {
    const div = document.createElement('div');
    div.className = 'cart-item';
    div.innerHTML = `
      <span>${item.name} x ${item.quantity}</span>
      <span>‚Çπ${item.price * item.quantity}</span>
      <button title="Remove one" style="background:#dc3545;color:#fff;border:none;border-radius:3px;cursor:pointer;padding:2px 6px;">-</button>
    `;
    const btn = div.querySelector('button');
    btn.addEventListener('click', () => {
      app.removeFromCart(item.id);
    });
    cartItemsDiv.appendChild(div);
  });
  cartTotalDiv.textContent = Total: ‚Çπ${app.getCartTotal()};
}

// Event Listeners
vegFilter.addEventListener('change', (e) => {
  renderMenu(e.target.value);
});

paymentSelect.addEventListener('change', (e) => {
  const method = e.target.value;
  switch (method) {
    case 'creditCard': app.setPaymentStrategy(new CreditCardPayment()); break;
    case 'paypal': app.setPaymentStrategy(new PaypalPayment()); break;
    case 'cod': app.setPaymentStrategy(new CODPayment()); break;
  }
});
app.setPaymentStrategy(new CreditCardPayment());

proceedPaymentBtn.addEventListener('click', () => {
  if (Object.keys(app.cart).length === 0) {
    alert('Cart is empty!');
    return;
  }
  document.getElementById('paymentSection').style.display = 'block';
  proceedPaymentBtn.disabled = true;
});

placeOrderBtn.addEventListener('click', () => {
  app.invoker.setCommand(new PlaceOrderCommand(app));
  app.invoker.executeCommand();
});

cancelOrderBtn.addEventListener('click', () => {
  app.invoker.setCommand(new CancelOrderCommand(app));
  app.invoker.executeCommand();
});

// Initial Render
renderMenu();
updateCartDisplay();
</script>
</body>
</html>